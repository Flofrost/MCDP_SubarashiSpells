execute if score @s upgrade matches 1.. run xp add @s -50 levels
execute if score @s upgrade matches 1.. run particle reverse_portal ~ ~1 ~ 0 0 0 1 999
execute if score @s upgrade matches 1.. run playsound ui.toast.challenge_complete master @a ~ ~ ~ 1 1 
execute if score @s upgrade matches 1.. run clear @s written_book{Level:1}
give @s written_book{Tags:["spell_book"],Level:2,title:"Advanced Spell Book",author:"Flofrost",display:{Lore:['{"text":"The most powerful book of all."}','{"text":"Have fun annihilating your world!"}']},pages:['[{"text":"      Basic Spells\\n"},{"text":"\\n[Xp Succ]","underlined": true,"color":"#A0D100","hoverEvent":{"action":"show_text","contents":[{"text":"Convert your own xp back to orbs. For mending or sharing!"},{"text":"\\nNote: Crouch to cancel the spell.","color":"green"},{"text":"\\nIs this a communist spell I\'m too capitalist to use?","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 35"}},{"text":"\\n[Morning Wood]","underlined": true,"italic": true,"color":"#39BD00","hoverEvent":{"action":"show_text","contents":[{"text":"Throw an instantly growing oak tree."},{"text":"\\nSize: 5m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.tree0"}},{"text":"xp","color":"green"},{"text":"\\nA quick snack for a lumberjack!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 17"}},{"text":"\\n[Create Water]","italic": true,"color":"#0099FF","hoverEvent":{"action":"show_text","contents":[{"text":"Create a small pool of water."},{"text":"\\nSize: 2m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.water0"}},{"text":"xp","color":"green"},{"text":"\\nCould be mistaken as purifed urine.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 22"}},{"text":"\\n[Lightning Strike]","italic": true,"underlined": true,"color":"#DDDD00","hoverEvent":{"action":"show_text","contents":[{"text":"Summon a lightning bolt."},{"text":"\\nRange: 35m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.lightning0"}},{"text":"xp","color":"green"},{"text":"\\nYou\'d make Thor blush~","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 10"}},{"text":"\\n[Uno Reverse Card]","italic": true,"color":"#00C400","hoverEvent":{"action":"show_text","contents":[{"text":"Reflect all incoming projectiles, and absorb non-reflected damage."},{"text":"\\nDuration: 10s\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.reflect"}},{"text":"xp","color":"green"},{"text":"\\nno u","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 21"}},{"text":"\\n[Fireball]","italic": true,"underlined": true,"color":"#E3780E","hoverEvent":{"action":"show_text","contents":[{"text":"Shoot a fireball to burn your target."},{"text":"\\nPower: 4\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.fire0"}},{"text":"xp","color":"green"},{"text":"\\nA little 3rd degree burn won\'t kill anybody, right?","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 3"}},{"text":"\\n[Bridge]","italic": true,"underlined": true,"color":"#573013","hoverEvent":{"action":"show_text","contents":[{"text":"Build a long dirt bridge."},{"text":"\\nRange: 200m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.bridge"}},{"text":"xp","color":"green"},{"text":"\\nA very unsafe way to safely traval large gaps!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 27"}},{"text":"\\n[Morpho-Rabbit]","italic": true,"color":"#D18F3F","hoverEvent":{"action":"show_text","contents":[{"text":"Inhale the Rabbit\'s spirit, run faster and jump higher."},{"text":"\\nDuration: 5min\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.morph0"}},{"text":"xp","color":"green"},{"text":"\\nThat feel when you consume too much coffee.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 13"}},{"text":"\\n[Steal]","italic": true,"underlined": true,"color":"#A275E6","hoverEvent":{"action":"show_text","contents":[{"text":"Steal the held item from a player or loot a mob without killing it."},{"text":"\\nRange: 15m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.steal"}},{"text":"xp","color":"green"},{"text":"\\nUnfortunately, you can\'t steal panties in Minecraft...","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 9"}},{"text":"\\n[Skewer]","italic": true,"underlined": true,"color":"#FF0099","hoverEvent":{"action":"show_text","contents":[{"text":"Shoot one strong laser."},{"text":"\\nRange: 100m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.laser0"}},{"text":"xp","color":"green"},{"text":"\\nPenetrate your foes in a completely wholesome way.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 6"}},{"text":"\\n[Applied Horticulture]","color":"#00AA00","hoverEvent":{"action":"show_text","contents":[{"text":"Make your crops and plants around you grow instantly!"},{"text":"\\nRadius: Loaded Chunks\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.horticulture"}},{"text":"xp","color":"green"},{"text":"\\nMay cause lag while spell is active.","color":"#F0C800"},{"text":"\\nDon\'t Starve!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 31"}},{"text":"\\n[Coffee Coffee]","italic": true,"color":"dark_red","hoverEvent":{"action":"show_text","contents":[{"text":"Mine with incredible speed."},{"text":"\\nDuration: 3min\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.coffee"}},{"text":"xp","color":"green"},{"text":"\\nThis doesn\'t feel coffee coffee... You sure it\'s coffee?","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 16"}}]','[{"text":"  Intermediate Spells\\n"},{"text":"\\n[Schadenfreude]","italic": true,"color":"#FFA203","hoverEvent":{"action":"show_text","contents":[{"text":"Swap places with the targeted entity. Works through walls."},{"text":"\\nRange: 60m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.switch"}},{"text":"xp","color":"green"},{"text":"\\nOh me oh my, how the turn tables.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 20"}},{"text":"\\n[Yeetus Thornus]","italic": true,"underlined": true,"color":"dark_green","hoverEvent":{"action":"show_text","contents":[{"text":"Throw an instantly growing spruce tree that also impedes and hurts entities when it grows."},{"text":"\\nSize: 10m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.tree1"}},{"text":"xp","color":"green"},{"text":"\\nMr. Beast\'s forbidden toy.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 18"}},{"text":"\\n[Checkpoint]","color":"#C515E8","hoverEvent":{"action":"show_text","contents":[{"text":"Create a new teleportation key, to teleport to its saved location later."},{"text":"\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.teleport"}},{"text":"xp","color":"green"},{"text":"\\nUse the right key in the right dimention!","color":"#F0C800"},{"text":"\\nAh $#![, here we go again...","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 28"}},{"text":"\\n[Heal]","italic": true,"underlined": true,"color":"#FF1133","hoverEvent":{"action":"show_text","contents":[{"text":"Heal the targeted entity, if no targets are found, heal yourself."},{"text":"\\nRange: 30m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.heal0"}},{"text":"xp","color":"green"},{"text":"\\nAnother successful procedure!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 32"}},{"text":"\\n[Morpho-Fish]","italic": true,"color":"#4DA6FF","hoverEvent":{"action":"show_text","contents":[{"text":"Inhale the Sea\'s spirit, swim faster and breath underwater."},{"text":"\\nDuration: 5min\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.morph1"}},{"text":"xp","color":"green"},{"text":"\\nTrust me, I\'m a dolphin!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 14"}},{"text":"\\n[Fluid Drain]","italic": true,"color":"#00047D","hoverEvent":{"action":"show_text","contents":[{"text":"Clear all of the water, lava, and fire around you."},{"text":"\\nRange: 20m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.water1"}},{"text":"xp","color":"green"},{"text":"\\nYes, fire is plasma therefore a fluid, fight me!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 23"}},{"text":"\\n[Song of Storms]","italic": true,"underlined": true,"color":"#A19950","hoverEvent":{"action":"show_text","contents":[{"text":"Summon a shocking lightning bolt along with a thunderstorm."},{"text":"\\nRange: 50m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.lightning1"}},{"text":"xp\\nStorm Duration: 1min","color":"green"},{"text":"\\nThe thuderstorm may last forever if the gamerule \\"doWeatherCycle\\" is false.","color":"#F0C800"},{"text":"\\nThis one might get you cursed at instead of lifting curses. (but only in multiplayer)","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 11"}},{"text":"\\n[Cursed Ice Prison]","italic": true,"underlined": true,"color":"#9CD1FF","hoverEvent":{"action":"show_text","contents":[{"text":"Imprison the selcted target, or shield yourself if no targets are found."},{"text":"\\nRange: 40m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.ice1"}},{"text":"xp","color":"green"},{"text":"\\nWiz\'s favourite spell!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 26"}},{"text":"\\n[Sting Ray]","italic": true,"underlined": true,"color":"#FF0000","hoverEvent":{"action":"show_text","contents":[{"text":"Shoot one mighty piercing laser."},{"text":"\\nRange: 200m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.laser1"}},{"text":"xp","color":"green"},{"text":"\\nThis is only good on Tower Control.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 7"}},{"text":"\\n[Blazing Rain]","italic": true,"underlined": true,"color":"#FF4D00","hoverEvent":{"action":"show_text","contents":[{"text":"Summon a rain of fire."},{"text":"\\nLength: 30m\\nRadius: 6m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.fire1"}},{"text":"xp","color":"green"},{"text":"\\nIt\'s raining fire! Halleluja!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 4"}},{"text":"\\n[Instant House]","color":"#777777","hoverEvent":{"action":"show_text","contents":[{"text":"Insantly create a nice little house at your position."},{"text":"\\nSize: 11m X 11m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.house"}},{"text":"xp","color":"green"},{"text":"\\nHippity Hoppity, this place is now my property!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 33"}},{"text":"\\n[Explosion]","color":"#FF5E00","hoverEvent":{"action":"show_text","contents":[{"text":"Cast a big explosion in the distance."},{"text":"\\nRange: 100m\\nExplosion Radius: 25m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.explosion0"}},{"text":"xp","color":"green"},{"text":"\\nCreates large amounts of lag during the explosion.","color":"#F0C800"},{"text":"\\nWalk the path of Explosions!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 1"}}]','[{"text":"   Advanced Spells\\n"},{"text":"\\n[Morpho-Frog]","italic": true,"color":"#036100","hoverEvent":{"action":"show_text","contents":[{"text":"Inhale the Amphibian\'s spirit : run, leap, and swim with haste."},{"text":"\\nDuration: 10min\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.morph2"}},{"text":"xp","color":"green"},{"text":"\\nMatch the speed of Kirb in any environment!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 15"}},{"text":"\\n[Dryad\'s Heaven]","italic": true,"underlined": true,"color":"dark_green","hoverEvent":{"action":"show_text","contents":[{"text":"Throw an instantly growing dark oak tree that roots and injures entities as it grows."},{"text":"\\nSize: 15m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.tree2"}},{"text":"xp","color":"green"},{"text":"\\nFeel the pain I felt making this spell!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 19"}},{"text":"\\n[Cold Snap]","italic": true,"color":"#80D4FF","hoverEvent":{"action":"show_text","contents":[{"text":"Freeze and frostbite every entities around you."},{"text":"\\nRadius: 27m\\nFreeze Duration: 20s\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.ice0"}},{"text":"xp","color":"green"},{"text":"\\nStay Fresh!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 25"}},{"text":"\\n[Echolocator]","italic": true,"color":"#AE70FF","hoverEvent":{"action":"show_text","contents":[{"text":"Locate all ores around you. Precision decreases with distance."},{"text":"\\nRange: 70m\\nDuration: 1min 30s\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.locate"}},{"text":"xp","color":"green"},{"text":"\\nCauses lag spike followed by a large amount of entities.","color":"#F0C800"},{"text":"\\n981 003 commands at your service!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 29"}},{"text":"\\n[The Amputator]","italic": true,"color":"#FF2E2E","hoverEvent":{"action":"show_text","contents":[{"text":"Heal every thing around you, you included."},{"text":"\\nRange: 10m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.heal1"}},{"text":"xp","color":"green"},{"text":"\\nBe your team\'s mobile dispenser.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 36"}},{"text":"\\n[Inventory.zip]","color":"#000000","hoverEvent":{"action":"show_text","contents":[{"text":"Copy your entire inventory into a single item to retrieve it later."},{"text":"\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.zip"}},{"text":"xp","color":"green"},{"text":"\\nThe Pay to Win version of keepInventory.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 24"}},{"text":"\\n[Blessing]","underlined": true,"color":"aqua","hoverEvent":{"action":"show_text","contents":[{"text":"Grant the target a load of positive effects, apply it to yourself if no targets are found."},{"text":"\\nEffects: Luck, Strength, Resistance, Regeneration, Absorption, Fire Resistance, Saturation\\nDuration: 3min\\nRange: 5m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.bless"}},{"text":"xp","color":"green"},{"text":"\\nRemeber: Eris pads her chest.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 30"}},{"text":"\\n[Light of Saber]","italic": true,"underlined": true,"color":"#FFD70C","hoverEvent":{"action":"show_text","contents":[{"text":"Summon a glorious lightning bolt, with an electric trail leading to it."},{"text":"\\nRange: 65m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.lightning2"}},{"text":"xp","color":"green"},{"text":"\\nThis might be your popular phase!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 12"}},{"text":"\\n[Tenta Missiles]","color":"#BEED00","hoverEvent":{"action":"show_text","contents":[{"text":"Blast each selected target with a deadly missle."},{"text":"\\nRange: 170m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.tenta"}},{"text":"xp","color":"green"},{"text":"\\nDespite its name, the spell doesn\'t necessarly shoot 10 missiles.","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 34"}},{"text":"\\n[Meteor Shower]","underlined": true,"color":"#DD0000","hoverEvent":{"action":"show_text","contents":[{"text":"Make it rain meteors from the sky."},{"text":"\\nLength: 50m\\nRadius: 8m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.fire2"}},{"text":"xp","color":"green"},{"text":"\\nLe ciel nous tombe sur la tête!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 5"}},{"text":"\\n[Mega Laser]","color":"#CC66FF","hoverEvent":{"action":"show_text","contents":[{"text":"Shoot one powerful, piercing, and explosive laser."},{"text":"\\nRange: 150m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.laser2"}},{"text":"xp","color":"green"},{"text":"\\nBlack Hole and Mega Laser!\\nPalutena from Smash since 2014","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 8"}},{"text":"\\n[EXPLOSION!]","color":"#B83700","hoverEvent":{"action":"show_text","contents":[{"text":"Cast a massive explosion in the distance!"},{"text":"\\nRange: 150m\\nExplosion Radius: 50m\\nCost: ","color":"green"},{"color":"green","score":{"objective":"sublevel","name":"spells.explosion1"}},{"text":"xp","color":"green"},{"text":"\\nCreates massive amounts of lag during the explosion.","color":"#F0C800"},{"text":"\\nMegumin would be proud of you!","italic":true,"color":"gray"}]},"clickEvent":{"action":"run_command","value":"/trigger spell set 2"}}]','[{"text":"      Quickcasting\\n\\nMake special convinient items that cast the spells quickly and without the book! Put a quickcaster i yuor offhand and cast an available spell to assign it."},{"text":"\\n\\n   [Get Quickcaster]","color":"#00BB22","hoverEvent":{"action":"show_text","contents":[{"text":"Get a Quickcaster."},{"text":"\\nCost: 10xp","color":"green"}]},"clickEvent":{"action": "run_command","value":"/trigger upgrade"}}]','[{"text":"          Help\\n\\nSpells are casted by clicking or cast on their own. Crouch to cancel spells. Some Spells are very destructive, use with cution!\\nLegend:\\n"},{"text":"\\n[Continuous Cast]\\n","underlined":true},{"text":"\\n[Quickastable]","italic":true}]']}